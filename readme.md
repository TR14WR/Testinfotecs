# Клиент-серверная система распределенного интегрирования

## Описание

Система для численного интегрирования функции 1/ln(x) с использованием распределенных вычислений. Сервер разделяет задачу интегрирования между подключенными клиентами пропорционально количеству ядер CPU каждого клиента. Клиенты выполняют вычисления параллельно на всех доступных ядрах и возвращают результаты на сервер.

## Требования

- C++17 или выше
- CMake 3.28 или выше
- Boost библиотеки (serialization, system, asio, log)
- Conan (опционально, для управления зависимостями)

## Структура проекта

```
.
├── client/          # Клиентское приложение
│   ├── src/
│   │   └── main.cpp
│   └── CMakeLists.txt
├── server/          # Серверное приложение
│   ├── src/
│   │   └── main.cpp
│   └── CMakeLists.txt
├── common/          # Общие компоненты
│   ├── DataStructures.h
│   ├── Logger.h
│   ├── Logger.cpp
│   ├── Utils.h
│   └── CMakeLists.txt
├── CMakeLists.txt   # Корневой CMake файл
├── conanfile.py     # Conan конфигурация
└── readme.md        # Документация
```

## Сборка проекта

### Используя Conan (рекомендуется)

1. Установите Conan, если еще не установлен:
```bash
pip install conan
```

2. Создайте профиль сборки (если нужно):
```bash
conan profile detect --force
```

3. Установите зависимости и соберите проект:
```bash
conan install . --output-folder=build --build=missing
cd build
cmake .. -DCMAKE_TOOLCHAIN_FILE=conan_toolchain.cmake
cmake --build .
```

### Используя CMake напрямую

1. Убедитесь, что Boost установлен в системе:
   - Windows: используйте vcpkg или установите вручную
   - Linux: `sudo apt-get install libboost-all-dev` (Ubuntu/Debian)
   - macOS: `brew install boost`

2. Соберите проект:

**Windows (простой способ):**
```bash
build_and_run.bat
```

**Или вручную:**
```bash
mkdir build
cd build
cmake ..
cmake --build . --config Release
```

## Запуск приложения

### Важно: Порядок запуска

**Сначала запустите сервер, затем клиент(ов)!**

### Запуск приложения

**Windows (простой способ):**

1. Запустите сервер:
```bash
run_server.bat
# или
cd build\Release
server.exe
```

2. В другом окне запустите клиент:
```bash
run_client.bat
# или
cd build\Release
client.exe
```

**Linux/macOS:**

1. Запустите сервер:
```bash
./build/server
# или
cd build
./server
```

2. Сервер будет ожидать подключений клиентов на порту 12345.
   - Вы увидите сообщение "Ожидание подключения клиентов..."
   - Нажмите Enter после того, как подключите клиентов

3. После подключения клиентов введите параметры интегрирования:
   - Нижний предел интегрирования (должен быть > 1)
   - Верхний предел интегрирования
   - Шаг интегрирования (например, 0.001)

### Запуск клиента

1. **После запуска сервера**, в отдельном терминале запустите клиент:
```bash
./client
# или на Windows
client.exe
```

2. Клиент автоматически подключится к серверу на `127.0.0.1:12345`.

3. Можно запустить несколько клиентов для распределения нагрузки.

### Устранение неполадок

Если программа не запускается:

1. **Проверьте компиляцию:**
   ```bash
   cd build
   cmake ..
   cmake --build .
   ```

2. **Проверьте наличие зависимостей:**
   - Boost должен быть установлен и найден CMake
   - На Windows можно использовать vcpkg: `vcpkg install boost`

3. **Проверьте порт:**
   - Убедитесь, что порт 12345 не занят другим приложением
   - На Linux может потребоваться права root для портов < 1024 (но 12345 > 1024)

4. **Проверьте логи:**
   - Логи записываются в файл `integration_log.log`
   - Также проверьте вывод в консоль

5. **Ошибка подключения:**
   - Убедитесь, что сервер запущен до клиента
   - Проверьте, что адрес сервера правильный (по умолчанию 127.0.0.1)
   - Проверьте файрвол/антивирус

## Пример использования

1. Запустите сервер:
```bash
./server
```

2. В другом терминале запустите один или несколько клиентов:
```bash
./client
```

3. На сервере введите параметры интегрирования:
```
Введите нижний предел интегрирования: 2
Введите верхний предел интегрирования: 10
Введите шаг интегрирования: 0.001
```

4. Сервер распределит задачу между клиентами и выведет результат.

## Особенности реализации

- **Сериализация**: Используется Boost.Serialization для передачи данных между клиентом и сервером
- **Параллелизм**: Клиенты используют все доступные ядра CPU для вычислений
- **Распределение нагрузки**: Задачи распределяются пропорционально количеству ядер каждого клиента
- **Логирование**: Используется Boost.Log для записи событий в консоль и файл `integration_log.log`
- **Синхронизация**: Используются мьютексы и условные переменные для синхронизации потоков

## Логирование

Логи записываются в:
- Консоль (уровень INFO и выше)
- Файл `integration_log.log` (уровень TRACE и выше)

## Запуск тестов

Для сборки и запуска модульных тестов:

```bash
cd build
cmake .. -DBUILD_TESTS=ON
cmake --build .
ctest
```

Или запустить тесты напрямую:
```bash
./integration_tests
```

Тесты проверяют:
- Корректность вычисления функции 1/ln(x)
- Правильность интегрирования на различных интервалах
- Обработку граничных случаев
- Сериализацию структур данных

## Примечания

- Функция 1/ln(x) не определена при x <= 1, поэтому такие точки обрабатываются специальным образом
- Для корректной работы необходимо, чтобы нижний предел интегрирования был больше 1
- Рекомендуется использовать шаг интегрирования не более 0.01 для точных результатов
- Для запуска тестов требуется установленный GTest (Google Test Framework)

## Лицензия

Проект создан в учебных целях.
